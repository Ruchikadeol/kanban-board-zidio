{"version":3,"sources":["../../src/controllers/auth.controller.ts"],"sourcesContent":["import { NextFunction, Request, Response } from 'express';\nimport { CreateUserDto } from '@dtos/users.dto';\nimport { RequestWithUserId } from '@interfaces/auth.interface';\nimport { User } from '@interfaces/users.interface';\nimport AuthService from '@services/auth.service';\n\nclass AuthController {\n  public authService = new AuthService();\n\n  public signUp = async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      const userData: CreateUserDto = req.body;\n      const signUpUserData: User = await this.authService.signup(userData);\n\n      res.status(201).json({ data: signUpUserData, message: 'signup' });\n    } catch (error) {\n      next(error);\n    }\n  };\n\n  public logIn = async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      const userData: CreateUserDto = req.body;\n      const { tokenData, findUser } = await this.authService.login(userData);\n\n      res.cookie('Authorization', tokenData.token, { maxAge: tokenData.expiresIn, path: '/' });\n      res.status(200).json({ data: findUser, message: 'login', token: tokenData.token });\n    } catch (error) {\n      next(error);\n    }\n  };\n\n  public logOut = async (req: RequestWithUserId, res: Response, next: NextFunction) => {\n    try {\n      const userId: string = req.userId;\n      const logOutUserData: User = await this.authService.logout(userId);\n\n      res.cookie('Authorization', [''], { maxAge: 0 });\n      logOutUserData.password = undefined;\n      res.status(200).json({ data: logOutUserData, message: 'logout' });\n    } catch (error) {\n      next(error);\n    }\n  };\n}\n\nexport default AuthController;\n"],"names":["AuthController","authService","AuthService","signUp","req","res","next","userData","body","signUpUserData","signup","status","json","data","message","error","logIn","tokenData","findUser","login","cookie","token","maxAge","expiresIn","path","logOut","userId","logOutUserData","logout","password","undefined"],"mappings":";;;;+BA8CA;;;eAAA;;;oEA1CwB;;;;;;;;;;;;;;;;;;;AAExB,IAAA,AAAMA,iBAAN,MAAMA;;QACJ,uBAAOC,eAAc,IAAIC,oBAAW;QAEpC,uBAAOC,UAAS,OAAOC,KAAcC,KAAeC;YAClD,IAAI;gBACF,MAAMC,WAA0BH,IAAII,IAAI;gBACxC,MAAMC,iBAAuB,MAAM,IAAI,CAACR,WAAW,CAACS,MAAM,CAACH;gBAE3DF,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAMJ;oBAAgBK,SAAS;gBAAS;YACjE,EAAE,OAAOC,OAAO;gBACdT,KAAKS;YACP;QACF;QAEA,uBAAOC,SAAQ,OAAOZ,KAAcC,KAAeC;YACjD,IAAI;gBACF,MAAMC,WAA0BH,IAAII,IAAI;gBACxC,MAAM,EAAES,SAAS,EAAEC,QAAQ,EAAE,GAAG,MAAM,IAAI,CAACjB,WAAW,CAACkB,KAAK,CAACZ;gBAE7DF,IAAIe,MAAM,CAAC,iBAAiBH,UAAUI,KAAK,EAAE;oBAAEC,QAAQL,UAAUM,SAAS;oBAAEC,MAAM;gBAAI;gBACtFnB,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAMK;oBAAUJ,SAAS;oBAASO,OAAOJ,UAAUI,KAAK;gBAAC;YAClF,EAAE,OAAON,OAAO;gBACdT,KAAKS;YACP;QACF;QAEA,uBAAOU,UAAS,OAAOrB,KAAwBC,KAAeC;YAC5D,IAAI;gBACF,MAAMoB,SAAiBtB,IAAIsB,MAAM;gBACjC,MAAMC,iBAAuB,MAAM,IAAI,CAAC1B,WAAW,CAAC2B,MAAM,CAACF;gBAE3DrB,IAAIe,MAAM,CAAC,iBAAiB;oBAAC;iBAAG,EAAE;oBAAEE,QAAQ;gBAAE;gBAC9CK,eAAeE,QAAQ,GAAGC;gBAC1BzB,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEC,MAAMc;oBAAgBb,SAAS;gBAAS;YACjE,EAAE,OAAOC,OAAO;gBACdT,KAAKS;YACP;QACF;;AACF;MAEA,WAAef"}